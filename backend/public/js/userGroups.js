(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"94RG":function(e,t,r){"use strict";r.r(t);r("i/QD"),r("4a4N"),r("QSGA");var n=r("ALZW"),o={name:"TheUserGroups",components:{TabMenu:r.n(n).a},data:function(){return{items:[{label:"Управление ролями",icon:"pi pi-fw pi-key",to:"/user-groups"},{label:"Список пользователей",icon:"pi pi-fw pi-users",to:"/user-groups/user"}]}},computed:{showTabs:function(){return void 0===this.$route.meta.type}}},i=(r("Txet"),r("KHd+")),a=Object(i.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("main",{staticClass:"container the-user-groups"},[this._m(0),this._v(" "),this.showTabs?t("TabMenu",{attrs:{model:this.items}}):this._e(),this._v(" "),t("router-view",{class:this.showTabs?"the-user-groups__tab-content":""})],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("header",{staticClass:"row the-user-groups__header"},[t("h3",{staticClass:"col"},[this._v("UserGroups")]),this._v(" "),t("h5",{staticClass:"col"},[this._v("Управление группами доступа")])])}],!1,null,null,null);t.default=a.exports},"B/hR":function(e,t,r){var n=r("oMtQ");"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,o);n.locals&&(e.exports=n.locals)},B4ib:function(e,t,r){(e.exports=r("I1BE")(!1)).push([e.i,"/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Color ~~~ */\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Font ~~~ */\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Size ~~~ */\n.the-user-groups {\n  /* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ .p-dialog ~~~ */\n  /* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ .p-tree ~~~ */\n  /* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ __edit-form ~~~ */\n}\n.the-user-groups__header {\n  flex-direction: column;\n}\n.the-user-groups .the-user-groups__tab-content .p-datatable-header {\n  display: flex;\n  padding: 1rem;\n  border-top: unset;\n  border-radius: unset;\n}\n.the-user-groups__id-body, .the-user-groups__action-body {\n  text-align: center;\n}\n.the-user-groups__id-header {\n  width: 5em;\n}\n.the-user-groups__action-header {\n  width: 8em;\n}\n.the-user-groups__action-body .pi {\n  font-size: 1.5em;\n}\n.the-user-groups .p-dialog {\n  min-width: 20em;\n}\n.the-user-groups .p-dialog-footer {\n  text-align: right;\n}\n.the-user-groups .p-dialog-footer button:last-child {\n  margin-right: 0;\n}\n.the-user-groups__remove-dialog .p-dialog-content {\n  text-align: center;\n}\n.the-user-groups .p-tree {\n  padding: 0;\n  border: unset;\n}\n.the-user-groups__edit-form > .row {\n  flex-direction: column;\n  margin-bottom: 1rem;\n}\n.the-user-groups__edit-form .p-inputtext,\n.the-user-groups__edit-form table {\n  width: 100%;\n}\n.the-user-groups__edit-form__buttons .col {\n  text-align: right;\n}",""])},Dx4W:function(e,t,r){"use strict";r("a6Sn")},"KnK+":function(e,t,r){"use strict";var n=r("txcL"),o={name:"TheContentMixin",methods:{generateBreadcrumb:function(e){this.$store.dispatch(n.a,e)},getTitle:function(e){return e[e.length-1].text},setNotifications:function(e){this.$store.dispatch(n.b,e)},scrollToTop:function(){window.scroll({top:0,left:0,behavior:"smooth"})}}},i=r("KHd+"),a=Object(i.a)(o,void 0,void 0,!1,null,null,null);t.a=a.exports},OFK6:function(e,t,r){var n=r("B4ib");"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,o);n.locals&&(e.exports=n.locals)},Txet:function(e,t,r){"use strict";r("OFK6")},UbkN:function(e,t,r){"use strict";var n=r("o0o1"),o=r.n(n),i=r("L2JU"),a=r("GM0M"),s=r("vDqi"),l=r.n(s);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){m(i,n,o,a,s,"next",e)}function s(e){m(i,n,o,a,s,"throw",e)}a(void 0)}))}}var p={name:"TheUserGroupsBroker",data:function(){return{isLoading:!1}},methods:{getListApp:function(){var e=arguments,t=this;return f(o.a.mark((function r(){var n,i;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:null,t.isLoading=!0,i=null!==n?{id:n}:null,r.next=5,l.a.get("/api/general/get-application",{payload:i}).then((function(e){return e.data})).catch((function(e){var t=Object.keys(e.response.data.errors)[0];console.error("get-application",e.response.data.errors[t][0])})).finally((function(){return t.isLoading=!1}));case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),r)})))()},getData:function(e,t){var r=arguments,n=this;return f(o.a.mark((function i(){var a,s;return o.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return a=r.length>2&&void 0!==r[2]?r[2]:null,n.isLoading=!0,s=null!==e?{id:e}:null,o.abrupt("return",l.a.get("/api/user-groups/".concat(t),u(u({},s),a)).then((function(e){return e.data})).catch((function(e){var r=Object.keys(e.response.data.errors)[0];console.error("".concat(t,":"),e.response.data.errors[r][0])})).finally((function(){return n.isLoading=!1})));case 4:case"end":return o.stop()}}),i)})))()}}},v=r("KHd+");function _(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}var h,b,g={name:"TheUserGroupsMixin",mixins:[Object(v.a)(p,void 0,void 0,!1,null,null,null).exports],computed:Object(i.c)({listRole:function(e){return e.userGroups.listRole},treeData:function(){return null===this.listRole?[]:this.getTreeData()}}),methods:{getRoleName:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null==e||null===this.listRole)return null;if(0==e)return"нет";var r=this.listRole.filter((function(t){return t.id==e})).shift();return void 0===r?"[deleted]":0==r.parent_id?r.name:t&&null!==r.id_parent?this.getRoleName(r.parent_id)+" > "+r.name:r.name},getTreeData:function(){var e,t=this,r=[],n=[],o=[];return this.listRole.forEach((function(e){e.id!=t.roleId&&e.parent_id!=t.roleId&&(n.push(Object.assign({},e)),o.push(e.id))})),n.forEach((function(t){t.key=t.id,t.label=t.name,t.data=t.id,t.parent_id&&-1!==(e=o.indexOf(t.parent_id))?n[e].children?n[e].children.push(t):n[e].children=[t]:r.push(t)})),r}},created:(h=o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.listRole){e.next=5;break}return e.next=3,this.getData(null,"get-role");case 3:t=e.sent,this.$store.dispatch(a.d,t);case 5:case"end":return e.stop()}}),e,this)})),b=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=h.apply(e,t);function i(e){_(o,r,n,i,a,"next",e)}function a(e){_(o,r,n,i,a,"throw",e)}i(void 0)}))},function(){return b.apply(this,arguments)})},y=Object(v.a)(g,void 0,void 0,!1,null,null,null);t.a=y.exports},Uy9d:function(e,t,r){"use strict";r.r(t);var n=r("I6XT"),o=r.n(n),i=r("xSS+"),a=r.n(i),s=r("euwY"),l=r.n(s),c=r("UbkN"),u={name:"RoleManagement",components:{DataTable:o.a,Column:a.a,Dialog:l.a},mixins:[c.a],data:function(){return{idItemRemove:0}},methods:{itemRemove:function(e){console.log("itemRemove",e),this.idItemRemove=0}}},d=r("KHd+"),m=Object(d.a)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("DataTable",{attrs:{value:e.listRole},scopedSlots:e._u([{key:"header",fn:function(){return[r("router-link",{staticClass:"btn btn-sm btn-outline-primary",attrs:{to:"/user-groups/role-create"}},[e._v("\n            Добавить роль\n        ")])]},proxy:!0}])},[e._v(" "),r("Column",{attrs:{field:"id",header:"ID",headerClass:"the-user-groups__id-header",bodyClass:"the-user-groups__id-body"}}),e._v(" "),r("Column",{attrs:{field:"name",header:"Название"}}),e._v(" "),r("Column",{attrs:{header:"Родительская группа"},scopedSlots:e._u([{key:"body",fn:function(t){return[e._v("\n            "+e._s(e.getRoleName(t.data.parent_id))+"\n        ")]}}])}),e._v(" "),r("Column",{attrs:{field:"description",header:"Описание"}}),e._v(" "),r("Column",{attrs:{headerClass:"the-user-groups__action-header",bodyClass:"the-user-groups__action-body"},scopedSlots:e._u([{key:"body",fn:function(t){return[t.data.id>1?r("router-link",{attrs:{to:"/user-groups/role-edit/"+t.data.id}},[r("i",{staticClass:"pi pi-pencil btn btn-sm btn-outline-secondary"})]):e._e(),e._v(" "),t.data.id>2?r("i",{staticClass:"pi pi-trash btn btn-sm btn-outline-danger",on:{click:function(){return e.idItemRemove=t.data.id}}}):e._e()]}}])}),e._v(" "),r("Dialog",{staticClass:"the-user-groups__remove-dialog",attrs:{showHeader:!1,modal:!0,visible:e.idItemRemove>0},scopedSlots:e._u([{key:"footer",fn:function(){return[r("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:function(){return e.itemRemove(e.idItemRemove)}}},[e._v("\n                Удалить\n            ")]),e._v(" "),r("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(){return e.idItemRemove=0}}},[e._v("\n                Отмена\n            ")])]},proxy:!0}])},[e._v('\n        Удалить роль "'+e._s(e.getRoleName(e.idItemRemove,!1))+'"?\n        ')])],1)}),[],!1,null,null,null);t.default=m.exports},a6Qn:function(e,t,r){"use strict";r("B/hR")},a6Sn:function(e,t,r){var n=r("ndW+");"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,o);n.locals&&(e.exports=n.locals)},iWVk:function(e,t,r){"use strict";r.r(t);var n=r("o0o1"),o=r.n(n),i=r("vDqi"),a=r.n(i),s=r("0ZTh"),l=r("L2JU"),c=r("KnK+"),u=r("kGIl"),d=r.n(u),m=(r("5A0h"),r("EvnB"));function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function _(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){v(i,n,o,a,s,"next",e)}function s(e){v(i,n,o,a,s,"throw",e)}a(void 0)}))}}a.a.defaults.withCredentials=!0;var h,b={name:"Settlements",mixins:[c.a],data:function(){return{breadcrumbs:[{text:"Главная",to:{path:"/"}},{text:"Settlements",active:!0}],errors:null,isLoading:!0,classes:{table:{"table-striped table-sm":!0,"table-bordered my-class-two":function(e){return!0}}},columns:[{label:"id",name:"id",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"abbr",name:"abbr",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"bdd",name:"bdd",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"city_type",name:"city_type",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"district",name:"district",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"id_area",name:"id_area",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"id_distr",name:"id_distr",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"id_region",name:"id_region",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"kato",name:"kato",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"name_en",name:"name_en",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"name_ru",name:"name_ru",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"oblast",name:"oblast",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"okrug",name:"okrug",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"pop_2009",name:"pop_2009",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"raion",name:"raion",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"},{label:"created_at",name:"created_at",filter:{type:"simple",placeholder:""},sort:!0,column_classes:"id_column"}],config:{checkbox_rows:!0,rows_selectable:!0,per_page:20,global_search:{placeholder:"Поиск",visibility:!0,case_sensitive:!1},per_page_options:[5,10,20,30],show_refresh_button:!1,show_reset_button:!1},checkedId:null}},components:{Loading:d.a,VueBootstrap4Table:m.a},created:(h=_(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData();case 2:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)}),computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Object(l.b)(["items"])),mounted:function(){this.generateBreadcrumb(this.breadcrumbs)},methods:{fetchData:function(){var e=this;return _(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch(s.a);case 2:e.isLoading=!1;case 3:case"end":return t.stop()}}),t)})))()},onSelectRow:function(e){this.checkedId=e.selected_items[0].id,this.checkedId}}},g=(r("a6Qn"),r("KHd+")),y=Object(g.a)(b,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"settlement"},[r("loading",{attrs:{active:e.isLoading,"can-cancel":!1},on:{"update:active":function(t){e.isLoading=t}}}),e._v(" "),r("vue-bootstrap4-table",{attrs:{rows:e.items[0],columns:e.columns,config:e.config,classes:e.classes},on:{"on-select-row":e.onSelectRow}})],1)}),[],!1,null,null,null);t.default=y.exports},mxKb:function(e,t,r){"use strict";r.r(t);var n=r("o0o1"),o=r.n(n),i=r("L2JU"),a=r("GM0M"),s=r("UbkN"),l=r("vDqi"),c=r.n(l);function u(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){u(i,n,o,a,s,"next",e)}function s(e){u(i,n,o,a,s,"throw",e)}a(void 0)}))}}var m={name:"RoleBroker",data:function(){return{isLoading:!1}},methods:{createEditRole:function(e){var t=this;return d(o.a.mark((function r(){var n,i,a,s,l;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.id,i=void 0===n?null:n,a=e.role,s=e.right,t.isLoading=!0,l=null===i?"create-role":"edit-role",null!==i&&(a.id=i),r.next=6,c.a.post("/api/user-groups/".concat(l),a).then(function(){var e=d(o.a.mark((function e(r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.length){e.next=4;break}return void 0!==r.data.id&&(i=r.data.id),e.next=4,c.a.post("/api/user-groups/edit-right",{role_id:i,payload:JSON.stringify(s)}).catch((function(e){var t=Object.keys(e.response.data.errors)[0];console.error(e.response.data.errors[t][0])}));case 4:t.$router.push({path:"/user-groups"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var t=Object.keys(e.response.data.errors)[0];console.error(e.response.data.errors[t][0])})).finally((function(){return t.isLoading=!1}));case 6:case"end":return r.stop()}}),r)})))()}}},f=r("KHd+"),p=Object(f.a)(m,void 0,void 0,!1,null,null,null).exports,v=r("ZUkA"),_=r.n(v),h=r("euwY"),b=r.n(h),g=r("2+iP"),y=r.n(g),C={name:"RoleEditParent",components:{Button:_.a,Dialog:b.a,Tree:y.a},mixins:[s.a],props:{roleId:{type:Number,default:0},parentId:{type:Number,default:0}},data:function(){return{dialogVisible:!1,result:null,selectedKey:null}},computed:Object(i.c)({outputParent:function(){return 0==this.parentId?"Нет":this.getRoleName(this.parentId)}}),methods:{handleSelect:function(e){var t=e.data;this.result=t},handleRemove:function(){this.$emit("parentSelect",0)},handleOk:function(){this.$emit("parentSelect",this.result),this.handleClose()},handleClose:function(){this.dialogVisible=!1,this.result=null,this.selectedKey=null}}},$=(r("Dx4W"),Object(f.a)(C,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"p-inputgroup"},[r("div",{staticClass:"p-inputtext p-component",on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n            "+e._s(e.outputParent)+"\n        ")]),e._v(" "),e.parentId>0?r("Button",{staticClass:"p-button-danger",attrs:{icon:"pi pi-times"},on:{click:e.handleRemove}}):e._e()],1),e._v(" "),r("Dialog",{attrs:{modal:!0,visible:e.dialogVisible,showHeader:!1},scopedSlots:e._u([{key:"footer",fn:function(){return[r("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:e.handleOk}},[e._v("\n                Ок\n            ")]),e._v(" "),r("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:e.handleClose}},[e._v("\n                Отмена\n            ")])]},proxy:!0}])},[r("Tree",{attrs:{value:e.treeData,selectionMode:"single",selectionKeys:e.selectedKey},on:{"update:selectionKeys":function(t){e.selectedKey=t},"update:selection-keys":function(t){e.selectedKey=t},"node-select":e.handleSelect}})],1)],1)}),[],!1,null,null,null).exports),w=r("p714"),x=r.n(w),S=r("UeTD"),k=r.n(S);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){P(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function L(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){R(i,n,o,a,s,"next",e)}function s(e){R(i,n,o,a,s,"throw",e)}a(void 0)}))}}var I,j={name:"RoleEdit",mixins:[s.a,p],components:{RoleEditParrent:$,Accordion:x.a,AccordionTab:k.a},data:function(){return{payload:{role:{},right:[]},parentLabel:0,options:[{value:"-1",text:"Не используется"},{value:"1",text:"Разрешить"},{value:"0",text:"Запретить"}]}},computed:Object(i.c)({listApp:function(e){return e.userGroups.listApp},listAction:function(e){return e.userGroups.listAction},listRight:function(e){return e.userGroups.listRight},id:function(){return this.$route.params.id},edit:function(){return"edit"===this.$route.meta.type},role:function(){var e=this;if(this.edit&&null!==this.listRole){var t=this.listRole.filter((function(t){return t.id==e.$route.params.id}))[0];return this.parentLabel=t.parent_id,t}return{name:null,description:null,parent_id:0}},treeData:function(e){var t=this;if(null!=this.listApp&&null!=this.listAction&&null!=this.listRight){var r=[];return this.listApp.forEach((function(e){var n=[];t.listAction.forEach((function(r){if(r.app_id==e.id){var o=t.listRight.filter((function(e){return e.action_id==r.id&&e.role_id==t.id}))[0],i=0;void 0!==o&&(i=o.sign?1:2),n.push({key:"".concat(e.id,"-").concat(r.id),label:r.action,description:r.description,action:r.id,selected:t.options[i].value,type:"action"})}})),r.push({key:e.id,label:e.name,description:e.description,children:n})})),r}},submitLabel:function(){return this.edit?"Сохранить":"Добавить"}}),methods:{updateField:function(e,t){e!=this.role[t]?this.payload.role[t]=e:delete this.payload.role[t]},updateParent:function(e){if(e==this.role.parent_id)return delete this.payload.role.parent_id,void(this.parentLabel=this.role.parent_id);this.parentLabel=e,this.payload.role.parent_id=e},updateRight:function(e){var t=this.payload.right.findIndex((function(t){return t.action_id==e.action_id})),r=this.listRight.filter((function(t){return t.action_id==e.action_id}))[0].sign;if(t>=0)return r==e.sign?(delete this.payload.right[t],void(this.payload.right=this.payload.right.filter((function(e){return null!=e})))):void(this.payload.right[t].sign=e.sign);this.payload.right.push(e)},onSubmit:function(){var e=this;return L(o.a.mark((function t(){var r,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createEditRole(O({id:e.$route.params.id},e.payload));case 2:return t.next=4,e.getData(null,"get-role");case 4:return r=t.sent,e.$store.dispatch(a.d,r),t.next=8,e.getData(null,"get-right");case 8:n=t.sent,e.$store.dispatch(a.c,n);case 10:case"end":return t.stop()}}),t)})))()}},created:(I=L(o.a.mark((function e(){var t,r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.listApp){e.next=5;break}return e.next=3,this.getListApp();case 3:t=e.sent,this.$store.dispatch(a.b,t);case 5:if(null!==this.listAction){e.next=10;break}return e.next=8,this.getData(null,"get-action");case 8:r=e.sent,this.$store.dispatch(a.a,r);case 10:if(null!==this.listRight){e.next=15;break}return e.next=13,this.getData(null,"get-right");case 13:n=e.sent,this.$store.dispatch(a.c,n);case 15:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},D=Object(f.a)(j,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"conteiner the-user-groups__edit-form"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[e._v("Имя роли")]),e._v(" "),r("div",{staticClass:"col"},[r("input",{staticClass:"p-inputtext p-component",attrs:{type:"text"},domProps:{value:e.role.name},on:{input:function(t){return e.updateField(t.target.value,"name")}}})])]),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[e._v("Родительская роль")]),e._v(" "),r("RoleEditParrent",{staticClass:"col",attrs:{roleId:e.role.id,parentId:e.parentLabel},on:{parentSelect:e.updateParent}})],1),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[e._v("Описание")]),e._v(" "),r("div",{staticClass:"col"},[r("textarea",{staticClass:"p-inputtext",attrs:{rows:"3"},domProps:{value:e.role.description},on:{input:function(t){return e.updateField(t.target.value,"description")}}})])]),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[e._v("Действия")]),e._v(" "),r("div",{staticClass:"col"},[r("Accordion",e._l(e.treeData,(function(t){return r("AccordionTab",{key:t.key},[r("template",{slot:"header"},[r("span",[e._v(e._s(t.label))]),e._v(" "),r("i",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",value:t.description,expression:"item.description",modifiers:{hover:!0,right:!0}}],staticClass:"pi pi-info-circle"})]),e._v(" "),r("table",[r("tbody",e._l(t.children,(function(t){return r("tr",{key:t.key},[r("td",[e._v(e._s(t.label))]),e._v(" "),r("td",[r("i",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",value:t.description,expression:"\n                                            child.description\n                                        ",modifiers:{hover:!0,right:!0}}],staticClass:"pi pi-info-circle"})]),e._v(" "),r("td",[r("select",{staticClass:"custom-select",on:{change:function(r){var n=r.target;return e.updateRight({action_id:t.action,sign:n.value})}}},e._l(e.options,(function(n,o){return r("option",{key:o,domProps:{value:n.value,selected:t.selected==n.value}},[e._v("\n                                            "+e._s(n.text)+"\n                                        ")])})),0)])])})),0)])],2)})),1)],1)]),e._v(" "),r("div",{staticClass:"row the-user-groups__edit-form__buttons"},[r("div",{staticClass:"col"},[r("b-button",{attrs:{variant:"outline-primary",disabled:e.isLoading},on:{click:e.onSubmit}},[e.isLoading?r("b-spinner",{staticClass:"mr-1",attrs:{small:""}}):e._e(),e._v("\n                "+e._s(e.submitLabel)+"\n            ")],1),e._v(" "),r("router-link",{staticClass:"btn btn-outline-secondary",attrs:{to:"/user-groups"}},[e._v("\n                Отмена\n            ")])],1)])])}),[],!1,null,null,null);t.default=D.exports},nDvi:function(e,t,r){"use strict";r.r(t);var n=r("vDqi"),o=r.n(n),i=r("KnK+"),a=r("o0o1"),s=r.n(a),l=r("+5AO"),c=r("ta7f");function u(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){u(i,n,o,a,s,"next",e)}function s(e){u(i,n,o,a,s,"throw",e)}a(void 0)}))}}o.a.defaults.withCredentials=!0;var m={name:"TheServiceBar",data:function(){return{breadcrumbs:[{text:"Главная",to:{path:"/"}},{text:"Справочники",to:{path:"/reference"}},{text:"Сервис каталог",active:!0}],list:null,form_group:{group_name:""},formErrors:null,errors:null,isLoading:!0}},methods:{fetchGroup:function(){var e=this;return d(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch(l.i);case 2:e.isLoading=!1;case 3:case"end":return t.stop()}}),t)})))()},onSubmit0:function(){var e=this;return d(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.formErrors=null,e.$v.form_group.$touch(),!e.$v.form_group.$pending&&!e.$v.form_group.$error){t.next=4;break}return t.abrupt("return");case 4:return e.isLoading=!0,t.next=7,e.$store.dispatch(l.a,e.form_group);case 7:e,e.$bvModal.hide("modal-0");case 9:case"end":return t.stop()}}),t)})))()},activeElement:function(e){if(this.$route.params.id==e)return!0;if(!this.$route.params.id){var t=this.$store.getters.SERVICES_GROUPS;if(t&&t[0].id===e)return!0}return!1}},mounted:function(){this.fetchGroup()},computed:{elements:function(){var e=this.$store.getters.SERVICES_GROUPS;if(e)return e}},validations:{form_group:{group_name:{required:c.required}}}},f=r("KHd+"),p=Object(f.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"list-group"},[r("div",[r("input",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-0",modifiers:{"modal-0":!0}}],staticClass:"btn btn-link float-right",attrs:{type:"button",variant:"default",value:"Добавить группу"}})]),e._v(" "),r("b-modal",{attrs:{id:"modal-0",title:"Добавить группу"},on:{click:function(t){return e.$bvModal.show("bv-modal-example")}},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"})]},proxy:!0}])},[r("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit0(t)}}},[r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Название группы")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form_group.group_name,expression:"form_group.group_name"}],staticClass:"form-control",class:{"is-invalid":e.$v.form_group.group_name.$error},attrs:{type:"text"},domProps:{value:e.form_group.group_name},on:{blur:function(t){return e.$v.form_group.group_name.$touch()},input:function(t){t.target.composing||e.$set(e.form_group,"group_name",t.target.value)}}}),e._v(" "),e.$v.form_group.group_name.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-sm-10"},[r("button",{staticClass:"btn btn-primary btn-sm ml-3 mt-2"},[e._v("Сохранить")])])])])]),e._v(" "),e._l(e.elements,(function(t,n){return r("router-link",{key:n,staticClass:"list-group-item list-group-item-action",class:{active:e.activeElement(t.id)},attrs:{to:"/services/group/"+t.id}},[e._v(e._s(t.group_name)),r("span",{staticClass:"badge badge-light",staticStyle:{position:"relative",right:"10px",float:"right"}},[e._v(e._s(t.services.length))])])}))],2)}),[],!1,null,null,null).exports;function v(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}o.a.defaults.withCredentials=!0;var _={name:"CreateService",data:function(){return{form:{service_name:"",id_service_group:""},formErrors:null,errors:null,isLoading:!0}},methods:{onSubmit:function(){var e,t=this;return(e=s.a.mark((function e(){var r,n,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.formErrors=null,t.$v.form.$touch(),!t.$v.form.$pending&&!t.$v.form.$error){e.next=4;break}return e.abrupt("return");case 4:for(t.isLoading=!0,r={"content-type":"multipart/form-data"},n=new FormData,o=Object.keys(t.form),i=0;i<o.length;i++)name=o[i],n.append(name,t.form[name]);return n.append("attachment",t.attachment),e.next=12,t.$store.dispatch(l.b,n,r);case 12:t.$bvModal.hide("modal-1"),t.$router.push("/services/group/"+t.form.id_service_group);case 15:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){v(i,n,o,a,s,"next",e)}function s(e){v(i,n,o,a,s,"throw",e)}a(void 0)}))})()},onAttachmentChange:function(e){this.attachment=e.target.files[0]}},computed:{groups:function(){if(this.$store.getters.SERVICES_GROUPS)return this.$store.getters.SERVICES_GROUPS}},validations:{form:{service_name:{required:c.required},id_service_group:{required:c.required}}}},h=Object(f.a)(_,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("input",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-1",modifiers:{"modal-1":!0}}],staticClass:"btn btn-link float-right",attrs:{type:"button",value:"Добавить сервис"}}),e._v(" "),r("b-modal",{attrs:{id:"modal-1",title:"Добавить сервис"},on:{click:function(t){return e.$bvModal.show("bv-modal-example")}},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"})]},proxy:!0}])},[r("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Выбрать группу сервиса")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.form.id_service_group,expression:"form.id_service_group"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.id_service_group.$error},on:{blur:function(t){return e.$v.form.id_service_group.$touch()},change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"id_service_group",t.target.multiple?r:r[0])}}},e._l(e.groups,(function(t,n){return r("option",{key:n,domProps:{value:t.id}},[e._v("\n            "+e._s(t.group_name)+"\n          ")])})),0),e._v(" "),e.$v.form.id_service_group.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Имя сервиса")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.service_name,expression:"form.service_name"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.service_name.$error},attrs:{type:"text"},domProps:{value:e.form.service_name},on:{blur:function(t){return e.$v.form.service_name.$touch()},input:function(t){t.target.composing||e.$set(e.form,"service_name",t.target.value)}}}),e._v(" "),e.$v.form.service_name.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-sm-10"},[r("button",{staticClass:"btn btn-primary btn-sm ml-3 mt-2"},[e._v("Сохранить")])])])])])],1)}),[],!1,null,null,null).exports;function b(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){b(i,n,o,a,s,"next",e)}function s(e){b(i,n,o,a,s,"throw",e)}a(void 0)}))}}o.a.defaults.withCredentials=!0;var y={name:"TheServices",data:function(){return{form:{influence_condition_name:"",id_influence_group:""},formErrors:null,errors:null,isLoading:!0}},methods:{onSubmit:function(){var e=this;return g(s.a.mark((function t(){var r,n,o,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.formErrors=null,e.$v.form.$touch(),!e.$v.form.$pending&&!e.$v.form.$error){t.next=4;break}return t.abrupt("return");case 4:for(e.isLoading=!0,r={"content-type":"multipart/form-data"},n=new FormData,o=Object.keys(e.form),i=0;i<o.length;i++)name=o[i],n.append("form["+name+"]",e.form[name]);return n.append("attachment",e.attachment),t.next=12,e.$store.dispatch(l.c,n,r);case 12:e,e.$bvModal.hide("modal-1"),e.$router.push("/services/group/"+e.form.id_service_group);case 15:case"end":return t.stop()}}),t)})))()},onAttachmentChange:function(e){this.attachment=e.target.files[0]},fetchList:function(){var e=this;return g(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch(l.l);case 2:e.isLoading=!1;case 3:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.fetchList()},computed:{groups:function(){if(this.$store.getters.SERVICE_INFLUENCE_GROUPS)return this.$store.getters.SERVICE_INFLUENCE_GROUPS}},validations:{form:{influence_condition_name:{required:c.required},id_influence_group:{required:c.required}}}},C=Object(f.a)(y,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-modal",{attrs:{id:"modal-sicond",title:"Создать условие влияния"},on:{click:function(t){return e.$bvModal.show("bv-modal-example")}},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"})]},proxy:!0}])},[r("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Выбрать группу влияния")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.form.id_influence_group,expression:"form.id_influence_group"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.id_influence_group.$error},on:{blur:function(t){return e.$v.form.id_influence_group.$touch()},change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"id_influence_group",t.target.multiple?r:r[0])}}},e._l(e.groups,(function(t,n){return r("option",{key:n,domProps:{value:t.id}},[e._v("\n            "+e._s(t.influence_group_name)+"\n          ")])})),0),e._v(" "),e.$v.form.id_influence_group.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Название условия влияния")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.influence_condition_name,expression:"form.influence_condition_name"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.influence_condition_name.$error},attrs:{type:"text"},domProps:{value:e.form.influence_condition_name},on:{blur:function(t){return e.$v.form.influence_condition_name.$touch()},input:function(t){t.target.composing||e.$set(e.form,"influence_condition_name",t.target.value)}}}),e._v(" "),e.$v.form.influence_condition_name.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-sm-10"},[r("button",{staticClass:"btn btn-primary btn-sm float-left ml-3 mt-2"},[e._v("Сохранить")])])])])])],1)}),[],!1,null,null,null).exports;function $(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function w(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){$(i,n,o,a,s,"next",e)}function s(e){$(i,n,o,a,s,"throw",e)}a(void 0)}))}}o.a.defaults.withCredentials=!0;var x={name:"TheServices",data:function(){return{form:{id_service_influence:""},formErrors:null,errors:null,isLoading:!0}},methods:{onSubmit:function(){var e=this;return w(s.a.mark((function t(){var r,n,o,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.formErrors=null,e.$v.form.$touch(),!e.$v.form.$pending&&!e.$v.form.$error){t.next=4;break}return t.abrupt("return");case 4:for(e.isLoading=!0,r={"content-type":"multipart/form-data"},n=new FormData,o=Object.keys(e.form),i=0;i<o.length;i++)name=o[i],n.append("form["+name+"]",e.form[name]);return n.append("form[id_service]",e.$route.params.vid),n.append("attachment",e.attachment),t.next=13,e.$store.dispatch(l.d,n,r);case 13:e,e.$bvModal.hide("modal-sicons"),e.detailService(e.$route.params.vid);case 16:case"end":return t.stop()}}),t)})))()},detailService:function(e){this.$store.dispatch(l.j,e)},onAttachmentChange:function(e){this.attachment=e.target.files[0]},fetchList:function(){var e=this;return w(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch(l.k);case 2:e.isLoading=!1;case 3:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.fetchList()},computed:{groups:function(){if(this.$store.getters.SERVICE_INFLUENCE_CONDITIONS)return this.$store.getters.SERVICE_INFLUENCE_CONDITIONS}},validations:{form:{id_service_influence:{required:c.required}}}},S=Object(f.a)(x,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-modal",{attrs:{id:"modal-sicons",title:"Привязать условие влияния к сервису"},on:{click:function(t){return e.$bvModal.show("bv-modal-example")}},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"})]},proxy:!0}])},[r("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Выбрать влияющее соединение")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.form.id_service_influence,expression:"form.id_service_influence"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.id_service_influence.$error},on:{blur:function(t){return e.$v.form.id_service_influence.$touch()},change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"id_service_influence",t.target.multiple?r:r[0])}}},e._l(e.groups,(function(t,n){return r("option",{key:n,domProps:{value:t.id}},[e._v("\n            "+e._s(t.influence_condition_name)+"\n          ")])})),0),e._v(" "),e.$v.form.id_service_influence.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-sm-10"},[r("button",{staticClass:"btn btn-primary btn-sm float-left ml-3 mt-2"},[e._v("Сохранить")])])])])])],1)}),[],!1,null,null,null).exports;function k(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}o.a.defaults.withCredentials=!0;var E={name:"TheServices",data:function(){return{form:{trigger_name:"",influence_group_name:""},formErrors:null,errors:null,isLoading:!0}},methods:{onSubmit:function(){var e,t=this;return(e=s.a.mark((function e(){var r,n,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.formErrors=null,t.$v.form.$touch(),!t.$v.form.$pending&&!t.$v.form.$error){e.next=4;break}return e.abrupt("return");case 4:for(t.isLoading=!0,r={"content-type":"multipart/form-data"},n=new FormData,o=Object.keys(t.form),i=0;i<o.length;i++)name=o[i],n.append("form["+name+"]",t.form[name]);return n.append("attachment",t.attachment),e.next=12,t.$store.dispatch(l.e,n,r);case 12:t.$bvModal.hide("modal-1"),t.$router.push("/services/group/"+t.form.id_service_group);case 15:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){k(i,n,o,a,s,"next",e)}function s(e){k(i,n,o,a,s,"throw",e)}a(void 0)}))})()},onAttachmentChange:function(e){this.attachment=e.target.files[0]}},computed:{groups:function(){if(this.$store.getters.SERVICES_GROUPS)return this.$store.getters.SERVICES_GROUPS}},validations:{form:{trigger_name:{required:c.required},influence_group_name:{required:c.required}}}},O=Object(f.a)(E,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-modal",{attrs:{id:"modal-sigroups",title:"Создать группу условия влияния и его триггер"},on:{click:function(t){return e.$bvModal.show("bv-modal-example")}},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"})]},proxy:!0}])},[r("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Имя триггера")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.trigger_name,expression:"form.trigger_name"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.trigger_name.$error},attrs:{type:"text"},domProps:{value:e.form.trigger_name},on:{blur:function(t){return e.$v.form.trigger_name.$touch()},input:function(t){t.target.composing||e.$set(e.form,"trigger_name",t.target.value)}}}),e._v(" "),e.$v.form.trigger_name.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Имя группы влияния")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.influence_group_name,expression:"form.influence_group_name"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.influence_group_name.$error},attrs:{type:"text"},domProps:{value:e.form.influence_group_name},on:{blur:function(t){return e.$v.form.influence_group_name.$touch()},input:function(t){t.target.composing||e.$set(e.form,"influence_group_name",t.target.value)}}}),e._v(" "),e.$v.form.influence_group_name.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-sm-10"},[r("button",{staticClass:"btn btn-primary btn-sm float-left ml-3 mt-2"},[e._v("Сохранить")])])])])])],1)}),[],!1,null,null,null).exports;function P(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function R(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){P(i,n,o,a,s,"next",e)}function s(e){P(i,n,o,a,s,"throw",e)}a(void 0)}))}}o.a.defaults.withCredentials=!0;var L={name:"TheServices",data:function(){return{form:{id_problem_group:"",cause_1_name:"",cause_2_name:""},formErrors:null,errors:null,isLoading:!0}},methods:{onSubmit:function(){var e=this;return R(s.a.mark((function t(){var r,n,o,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.formErrors=null,e.$v.form.$touch(),!e.$v.form.$pending&&!e.$v.form.$error){t.next=4;break}return t.abrupt("return");case 4:for(e.isLoading=!0,r={"content-type":"multipart/form-data"},n=new FormData,o=Object.keys(e.form),i=0;i<o.length;i++)name=o[i],n.append("form["+name+"]",e.form[name]);return n.append("attachment",e.attachment),t.next=12,e.$store.dispatch(l.f,n,r);case 12:e,e.$bvModal.hide("modal-1"),e.$router.push("/services/group/"+e.form.id_service_group);case 15:case"end":return t.stop()}}),t)})))()},onAttachmentChange:function(e){this.attachment=e.target.files[0]},fetchList:function(){var e=this;return R(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch(l.m);case 2:e.isLoading=!1;case 3:case"end":return t.stop()}}),t)})))()}},computed:{groups:function(){if(this.$store.getters.SERVICE_PROBLEM_GROUPS)return this.$store.getters.SERVICE_PROBLEM_GROUPS;this.fetchList()}},validations:{form:{id_problem_group:{required:c.required},cause_1_name:{required:c.required},cause_2_name:{required:c.required}}}},I=Object(f.a)(L,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-modal",{attrs:{id:"modal-spcauses",title:"Создать возможные причины"},on:{click:function(t){return e.$bvModal.show("bv-modal-example")}},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"})]},proxy:!0}])},[r("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Название проблемной группы")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.form.id_problem_group,expression:"form.id_problem_group"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.id_problem_group.$error},on:{blur:function(t){return e.$v.form.id_problem_group.$touch()},change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"id_problem_group",t.target.multiple?r:r[0])}}},e._l(e.groups,(function(t,n){return r("option",{key:n,domProps:{value:t.id}},[e._v("\n            "+e._s(t.group_name)+"\n          ")])})),0),e._v(" "),e.$v.form.id_problem_group.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Случай 1")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.cause_1_name,expression:"form.cause_1_name"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.cause_1_name.$error},attrs:{type:"text"},domProps:{value:e.form.cause_1_name},on:{blur:function(t){return e.$v.form.cause_1_name.$touch()},input:function(t){t.target.composing||e.$set(e.form,"cause_1_name",t.target.value)}}}),e._v(" "),e.$v.form.cause_1_name.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Случай 2")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.cause_2_name,expression:"form.cause_2_name"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.cause_2_name.$error},attrs:{type:"text"},domProps:{value:e.form.cause_2_name},on:{blur:function(t){return e.$v.form.cause_2_name.$touch()},input:function(t){t.target.composing||e.$set(e.form,"cause_2_name",t.target.value)}}}),e._v(" "),e.$v.form.cause_2_name.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-sm-10"},[r("button",{staticClass:"btn btn-primary btn-sm float-left ml-3 mt-2"},[e._v("Сохранить")])])])])])],1)}),[],!1,null,null,null).exports;function j(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function D(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){j(i,n,o,a,s,"next",e)}function s(e){j(i,n,o,a,s,"throw",e)}a(void 0)}))}}o.a.defaults.withCredentials=!0;var U={name:"CreateServiceProblemConns",data:function(){return{form:{id_problem_group:""},formErrors:null,errors:null,isLoading:!0}},methods:{onSubmit:function(){var e=this;return D(s.a.mark((function t(){var r,n,o,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.formErrors=null,e.$v.form.$touch(),!e.$v.form.$pending&&!e.$v.form.$error){t.next=4;break}return t.abrupt("return");case 4:for(e.isLoading=!0,r={"content-type":"multipart/form-data"},n=new FormData,o=Object.keys(e.form),i=0;i<o.length;i++)name=o[i],n.append("form["+name+"]",e.form[name]);return n.append("form[id_service]",e.$route.params.vid),n.append("attachment",e.attachment),t.next=13,e.$store.dispatch(l.g,n,r);case 13:e,e.$bvModal.hide("modal-1"),e.$router.push("/services/group/"+e.form.id_service_group);case 16:case"end":return t.stop()}}),t)})))()},onAttachmentChange:function(e){this.attachment=e.target.files[0]},fetchList:function(){var e=this;return D(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch(l.m);case 2:e.isLoading=!1;case 3:case"end":return t.stop()}}),t)})))()}},computed:{groups:function(){if(this.$store.getters.SERVICE_PROBLEM_GROUPS)return this.$store.getters.SERVICE_PROBLEM_GROUPS;this.fetchList()}},validations:{form:{id_problem_group:{required:c.required}}}},N=Object(f.a)(U,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-modal",{attrs:{id:"modal-spconns",title:"Привязать группу возможных причин к сервису"},on:{click:function(t){return e.$bvModal.show("bv-modal-example")}},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"})]},proxy:!0}])},[r("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Выбрать проблемную группу")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.form.id_problem_group,expression:"form.id_problem_group"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.id_problem_group.$error},on:{blur:function(t){return e.$v.form.id_problem_group.$touch()},change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"id_problem_group",t.target.multiple?r:r[0])}}},e._l(e.groups,(function(t,n){return r("option",{key:n,domProps:{value:t.id}},[e._v("\n            "+e._s(t.group_name)+"\n          ")])})),0),e._v(" "),e.$v.form.id_problem_group.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-sm-10"},[r("button",{staticClass:"btn btn-primary btn-sm float-left ml-3 mt-2"},[e._v("Сохранить")])])])])])],1)}),[],!1,null,null,null).exports;function T(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}o.a.defaults.withCredentials=!0;var q={name:"TheServices",data:function(){return{form:{group_name:""},formErrors:null,errors:null,isLoading:!0}},methods:{onSubmit:function(){var e,t=this;return(e=s.a.mark((function e(){var r,n,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.formErrors=null,t.$v.form.$touch(),!t.$v.form.$pending&&!t.$v.form.$error){e.next=4;break}return e.abrupt("return");case 4:for(t.isLoading=!0,r={"content-type":"multipart/form-data"},n=new FormData,o=Object.keys(t.form),i=0;i<o.length;i++)name=o[i],n.append("form["+name+"]",t.form[name]);return n.append("attachment",t.attachment),e.next=12,t.$store.dispatch(l.h,n,r);case 12:t.$bvModal.hide("modal-1");case 14:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){T(i,n,o,a,s,"next",e)}function s(e){T(i,n,o,a,s,"throw",e)}a(void 0)}))})()},onAttachmentChange:function(e){this.attachment=e.target.files[0]}},computed:{groups:function(){if(this.$store.getters.SERVICES_GROUPS)return this.$store.getters.SERVICES_GROUPS}},validations:{form:{group_name:{required:c.required}}}},G=Object(f.a)(q,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-modal",{attrs:{id:"modal-spgroups",title:"Создать группу возможных причин"},on:{click:function(t){return e.$bvModal.show("bv-modal-example")}},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"})]},proxy:!0}])},[r("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("label",{staticClass:"col-sm-10 col-form-label",attrs:{for:"staticEmail"}},[e._v("Название группы")]),e._v(" "),r("div",{staticClass:"col-sm-10"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.group_name,expression:"form.group_name"}],staticClass:"form-control",class:{"is-invalid":e.$v.form.group_name.$error},attrs:{type:"text"},domProps:{value:e.form.group_name},on:{blur:function(t){return e.$v.form.group_name.$touch()},input:function(t){t.target.composing||e.$set(e.form,"group_name",t.target.value)}}}),e._v(" "),e.$v.form.group_name.required?e._e():r("div",{staticClass:"invalid-feedback"},[e._v("\n          Обязательно для заполнения\n        ")])]),e._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-sm-10"},[r("button",{staticClass:"btn btn-primary btn-sm float-left ml-3 mt-2"},[e._v("Сохранить")])])])])])],1)}),[],!1,null,null,null).exports;o.a.defaults.withCredentials=!0;var A={name:"TheServices",mixins:[i.a],data:function(){return{breadcrumbs:[{text:"Главная",to:{path:"/"}},{text:"Справочники",to:{path:"/reference"}},{text:"Сервис каталог",active:!0}],form:{service_name:""},formErrors:null,errors:null,isLoading:!0,influenceConns:null,problemConns:null,serviceList:null,serviceGroups:null}},mounted:function(){var e=this;this.generateBreadcrumb(this.breadcrumbs),this.$store.getters.SERVICES_GROUPS?(this.serviceList=this.$store.getters.SERVICES_GROUPS[0].services,this.detailService(this.$store.getters.SERVICES_GROUPS[0].services[0].id)):setTimeout((function(){e.serviceList=e.$store.getters.SERVICES_GROUPS[0].services,e.detailService(e.$store.getters.SERVICES_GROUPS[0].services[0].id)}),1500)},methods:{groupService:function(e){if(this.$store.getters.SERVICES_GROUPS){var t=this.$store.getters.SERVICES_GROUPS.filter((function(t){return t.id==e}));this.serviceList=t[0].services,this.detailService(this.serviceList[0].id)}},detailService:function(e){this.$store.dispatch(l.j,e)}},computed:{group:function(){return this.$route.params.id?this.$route.params.id:this.$store.getters.SERVICES_GROUPS?this.$store.getters.SERVICES_GROUPS[0].id:void 0},serviceGroup:function(){return this.$store.getters.SERVICES_GROUPS},detail:function(){return this.$store.getters.SERVICE_DETAIL}},watch:{"$route.params.id":{handler:function(e){this.groupService(this.$route.params.id)}},"$route.params.vid":{handler:function(e){if(this.$route.params.vid)return this.detailService(this.$route.params.vid)}}},components:{TheServicesBar:p,CreateService:h,CreateServiceInfluenceConditions:C,CreateServiceInfluenceConns:S,CreateServiceInfluenceGroups:O,CreateServiceProblemCauses:I,CreateServiceProblemConns:N,CreateServiceProblemGroups:G},validations:{form:{service_name:{required:c.required}},form_group:{group_name:{required:c.required}}}},M=Object(f.a)(A,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"row mx-0"},[r("div",{staticClass:"col-md-2 p-0 h-100 left-bar-1 overflow-auto test"},[r("TheServicesBar")],1),e._v(" "),r("div",{staticClass:"col-md-2 p-0 h-100 left-bar-2"},[r("div",{staticClass:"list-group"},[r("CreateService"),e._v(" "),e._l(e.serviceList,(function(t,n){return r("router-link",{key:n,staticClass:"list-group-item list-group-item-action",attrs:{to:"/services/group/"+e.group+"/view/"+t.id}},[r("div",{staticClass:"d-flex w-100 justify-content-between"},[e._v("\n          "+e._s(t.service_name)+"\n        ")])])}))],2)]),e._v(" "),r("div",{staticClass:"col-md-8 h-100"},[e.detail?r("div",{staticClass:"detail_view_group"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-10"},[r("h5",{staticClass:"sidebar3-header"},[e._v(e._s(e.detail.service_name))])]),e._v(" "),r("div",{staticClass:"col-sm-2"},[r("b-dropdown",{staticClass:"m-0 mt-0 float-right",attrs:{id:"dropdown-right",right:"",text:"Группы и влияние",variant:"dark"}},[r("b-dropdown-item",[r("span",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-spgroups",modifiers:{"modal-spgroups":!0}}]},[e._v("Создать группу возможных причин")])]),e._v(" "),r("b-dropdown-item",[r("span",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-spcauses",modifiers:{"modal-spcauses":!0}}]},[e._v("Создать возможные причины")])]),e._v(" "),r("b-dropdown-item",[r("span",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-spconns",modifiers:{"modal-spconns":!0}}]},[e._v("Привязать группу возможных причин к сервису")])]),e._v(" "),r("b-dropdown-item",[r("span",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-sigroups",modifiers:{"modal-sigroups":!0}}]},[e._v("Создать группу условия влияния и его триггер")])]),e._v(" "),r("b-dropdown-item",[r("span",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-sicond",modifiers:{"modal-sicond":!0}}]},[e._v("Создать условие влияния")])]),e._v(" "),r("b-dropdown-item",[r("span",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-sicons",modifiers:{"modal-sicons":!0}}]},[e._v("Привязать условие влияния к сервису")])])],1)],1)]),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-12"},[r("span",{staticStyle:{"font-weight":"bold","font-style":"italic","font-size":"0.8rem"}},[e._v("Тригеры и условия влияния:")]),r("br"),e._v(" "),r("div",{staticClass:"border-top",staticStyle:{"min-height":"50px"}},[r("table",{staticClass:"table table-sm table-light",staticStyle:{"font-size":"0.9rem"}},[e._m(0),e._v(" "),r("tbody",e._l(e.detail.influence_conns,(function(t,n){return r("tr",{key:n},[t.influence_info?r("td",[e._v(e._s(t.influence_info.influence_condition_name))]):e._e(),e._v(" "),t.influence_info?r("td",[e._v("\n                    "+e._s(t.influence_info.group_info.influence_group_name)+"\n                  ")]):e._e(),e._v(" "),t.influence_info?r("td",[e._v(e._s(t.influence_info.group_info.trigger_name))]):e._e(),e._v(" "),r("td"),e._v(" "),r("td"),e._v(" "),r("td")])})),0)])])])]),e._v(" "),r("span",{staticStyle:{"font-weight":"bold","font-style":"italic","font-size":"0.8rem"}},[e._v("Возможные причины недоступности:")]),r("br"),e._v(" "),r("div",{staticClass:"border-top",staticStyle:{"min-height":"50px"}},[r("table",{staticClass:"table table-sm table-light"},[e._m(1),e._v(" "),e._l(e.detail.problem_conns,(function(t,n){return r("tr",{key:n},[t.problem_causes?r("td",[e._v("\n              "+e._s(t.problem_causes.cause_1_name)+"\n            ")]):e._e(),e._v(" "),t.problem_causes?r("td",[e._v("\n              "+e._s(t.problem_causes.cause_2_name)+"\n            ")]):e._e(),e._v(" "),t.problem_causes?r("td",[e._v("\n              "+e._s(t.problem_groups.group_name)+"\n            ")]):e._e()])}))],2)]),e._v(" "),r("span",{staticStyle:{"font-weight":"bold","font-style":"italic","font-size":"0.8rem"}},[e._v("Зависимые сервисы:")]),r("br"),e._v(" "),e._m(2),e._v(" "),r("span",{staticStyle:{"font-weight":"bold","font-style":"italic","font-size":"0.8rem"}},[e._v("Используемые ресурсы сервиса:")]),r("br"),e._v(" "),e._m(3),e._v(" "),r("span",{staticStyle:{"font-weight":"bold","font-style":"italic","font-size":"0.8rem"}},[e._v("Матрица приоритизации:")]),r("br"),e._v(" "),e._m(4),e._v(" "),r("span",{staticStyle:{"font-weight":"bold","font-style":"italic","font-size":"0.8rem"}},[e._v("Возможные группы, которые могут участвовать в устранении\n        проблемы:")]),r("br"),e._v(" "),e._m(5),e._v(" "),r("div",[r("CreateServiceInfluenceConditions"),e._v(" "),r("CreateServiceInfluenceConns"),e._v(" "),r("CreateServiceInfluenceGroups"),e._v(" "),r("CreateServiceProblemCauses"),e._v(" "),r("CreateServiceProblemConns"),e._v(" "),r("CreateServiceProblemGroups")],1)]):e._e()])])}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("th",[e._v("Условие")]),e._v(" "),r("th",[e._v("Группа")]),e._v(" "),r("th",[e._v("Триггер")]),e._v(" "),r("th",[e._v("All KZ")]),e._v(" "),r("th",[e._v("Large City")]),e._v(" "),r("th",[e._v("Small City")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("th",[this._v("Пр1")]),this._v(" "),t("th",[this._v("пр2")]),this._v(" "),t("th",[this._v("гр")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"border-top",staticStyle:{"min-height":"50px"}},[t("table",{staticClass:"table table-sm table-light"},[t("tr",[t("td")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"border-top",staticStyle:{"min-height":"50px"}},[t("table",{staticClass:"table table-sm table-light"},[t("tr",[t("td")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"border-top",staticStyle:{"min-height":"50px"}},[t("table",{staticClass:"table table-sm table-light"},[t("tr",[t("td")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"border-top",staticStyle:{"min-height":"50px"}},[t("table",{staticClass:"table table-sm table-light"},[t("tr",[t("td")])])])}],!1,null,null,null);t.default=M.exports},"ndW+":function(e,t,r){(e.exports=r("I1BE")(!1)).push([e.i,"/*  */",""])},oMtQ:function(e,t,r){(e.exports=r("I1BE")(!1)).push([e.i,"\n.id_column {\n  width: 120px;\n}\n.card{\n    background: none;\n}\n.source_name_column {\n  width: 180px;\n}\ntable {\n  font-size: 12px;\n}\n.settlement table thead {\n  background-color: #faebd7;\n  font-size: 12px;\n}\n.settlement .table-active input {\n  font-size: 12px;\n}\n.settlement .table-active > td {\n  background-color: cadetblue !important;\n}\n.settlement .card .card-header {\n  background-color: #5b9def87;\n\n  color: #303030;\n  border-bottom: 0px;\n}\n.settlement .card-body {\n  padding: 0px !important;\n}\n\n",""])},q5KW:function(e,t,r){"use strict";r.r(t);var n=r("o0o1"),o=r.n(n),i=r("L2JU"),a=r("GM0M"),s=r("UbkN"),l=r("vDqi"),c=r.n(l);function u(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}var d={name:"UserBroker",data:function(){return{isLoading:!1}},methods:{editUser:function(e,t){var r,n=this;return(r=o.a.mark((function r(){return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.isLoading=!0,r.next=3,c.a.post("/api/user-groups/edit-user",{id:e,role_id:t}).then((function(e){return Boolean(e.data)})).catch((function(e){var t=Object.keys(e.response.data.errors)[0];console.error(e.response.data.errors[t][0])})).finally((function(){return n.isLoading=!1}));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){u(i,n,o,a,s,"next",e)}function s(e){u(i,n,o,a,s,"throw",e)}a(void 0)}))})()}}},m=r("KHd+"),f=Object(m.a)(d,void 0,void 0,!1,null,null,null).exports,p=r("I6XT"),v=r.n(p),_=r("xSS+"),h=r.n(_),b=r("ZUkA"),g=r.n(b),y=r("euwY"),C=r.n(y),$=r("2+iP"),w=r.n($);function x(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function S(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){x(i,n,o,a,s,"next",e)}function s(e){x(i,n,o,a,s,"throw",e)}a(void 0)}))}}var k,E={name:"UserManagement",components:{DataTable:v.a,Column:h.a,Button:g.a,Dialog:C.a,Tree:w.a},mixins:[s.a,f],data:function(){return{selectedUserId:0,dialogSelectedRole:null,dialogTreeSelectedKey:null,setUserCreate:0,user_form:{name:"",email:""}}},computed:Object(i.c)({listUser:function(e){return e.userGroups.listUser}}),methods:{handleClickEdit:function(e){this.selectedUserId=e},handleSelect:function(e){var t=e.data;this.dialogSelectedRole=t},handleOk:function(){var e=this;return S(o.a.mark((function t(){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.editUser(e.selectedUserId,e.dialogSelectedRole);case 2:if(!t.sent){t.next=8;break}return t.next=6,e.getData(null,"get-user");case 6:r=t.sent,e.$store.dispatch(a.e,r);case 8:e.handleClose();case 9:case"end":return t.stop()}}),t)})))()},handleClose:function(){this.selectedUserId=0,this.dialogSelectedRole=null,this.dialogTreeSelectedKey=null},createUser:function(){var e=this;return S(o.a.mark((function t(){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.post("/api/user-groups/create-user",e.$data.user_form).then((function(t){console.log(t.data),e.setUserCreate=0})).catch((function(t){t.response.data&&(e.formErrors=t.response.data.errors)}));case 2:if(0!=e.setUserCreate){t.next=7;break}return t.next=5,e.getData(null,"get-user");case 5:r=t.sent,e.$store.dispatch(a.e,r);case 7:case"end":return t.stop()}}),t)})))()}},created:(k=S(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.listUser){e.next=5;break}return e.next=3,this.getData(null,"get-user");case 3:t=e.sent,this.$store.dispatch(a.e,t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},O=Object(m.a)(E,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("DataTable",{attrs:{value:e.listUser},scopedSlots:e._u([{key:"header",fn:function(){return[r("b-button",{attrs:{variant:"btn btn-sm btn-outline-primary",size:"sm"},on:{click:function(t){e.setUserCreate=1}}},[e._v("\n                Добавить пользователя\n            ")])]},proxy:!0}])},[e._v(" "),r("Column",{attrs:{field:"id",header:"ID",headerClass:"the-user-groups__id-header",bodyClass:"the-user-groups__id-body"}}),e._v(" "),r("Column",{attrs:{field:"name",header:"Имя"}}),e._v(" "),r("Column",{attrs:{header:"Группа"},scopedSlots:e._u([{key:"body",fn:function(t){return[e._v("\n                "+e._s(e.getRoleName(t.data.role_id))+"\n            ")]}}])}),e._v(" "),r("Column",{attrs:{headerClass:"the-user-groups__action-header",bodyClass:"the-user-groups__action-body"},scopedSlots:e._u([{key:"body",fn:function(t){return[t.data.id>1?r("i",{staticClass:"pi pi-pencil btn btn-sm btn-outline-secondary",on:{click:function(){return e.handleClickEdit(t.data.id)}}}):e._e()]}}])})],1),e._v(" "),r("Dialog",{attrs:{modal:!0,visible:e.selectedUserId>0,showHeader:!1},scopedSlots:e._u([{key:"footer",fn:function(){return[r("b-button",{attrs:{variant:"outline-primary",size:"sm",disabled:null===e.dialogSelectedRole},on:{click:e.handleOk}},[e._v("\n                Ок\n            ")]),e._v(" "),r("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:e.handleClose}},[e._v("\n                Отмена\n            ")])]},proxy:!0}])},[r("Tree",{attrs:{value:e.treeData,selectionMode:"single",selectionKeys:e.dialogTreeSelectedKey},on:{"update:selectionKeys":function(t){e.dialogTreeSelectedKey=t},"update:selection-keys":function(t){e.dialogTreeSelectedKey=t},"node-select":e.handleSelect}})],1),e._v(" "),r("Dialog",{attrs:{modal:!0,visible:e.setUserCreate>0,showHeader:!0},scopedSlots:e._u([{key:"header",fn:function(){return[e._v("\n            Создать пользователя \n        ")]},proxy:!0},{key:"footer",fn:function(){return[r("b-button",{attrs:{variant:"outline-primary",size:"sm",disabled:null===e.user_form.name&&null===e.user_form.email},on:{click:function(t){return e.createUser()}}},[e._v("\n                Создаль\n            ")]),e._v(" "),r("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(t){e.setUserCreate=0}}},[e._v("\n                Отмена\n            ")])]},proxy:!0}])},[e._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"user_name"}},[e._v("Имя пользователя")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user_form.name,expression:"user_form.name"}],staticClass:"form-control",attrs:{type:"text",id:"user_name"},domProps:{value:e.user_form.name},on:{input:function(t){t.target.composing||e.$set(e.user_form,"name",t.target.value)}}})]),e._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"user_email"}},[e._v("Email пользователя")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user_form.email,expression:"user_form.email"}],staticClass:"form-control",attrs:{type:"text",id:"user_email"},domProps:{value:e.user_form.email},on:{input:function(t){t.target.composing||e.$set(e.user_form,"email",t.target.value)}}})])])],1)}),[],!1,null,null,null);t.default=O.exports}}]);